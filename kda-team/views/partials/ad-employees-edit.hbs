<!-- Modal Sửa Sản Phẩm -->
<div class="modal fade" id="editEmployeeModal" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header border-0">
                <h5 class="modal-title">
                    <span class="fw-mediumbold">Sửa</span>
                    <span class="fw-light">Nhân viên</span>
                </h5>
                <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editProductForm">
                    <!-- Tên sản phẩm -->
                    <div class="form-group">
                        <label>Tên Nhân viên</label>
                        <input type="text" id="editTenNhanVien" class="form-control" />
                    </div>
                    <!-- Loại sản phẩm -->
                    <div class="form-group">
                        <label>Căn cước công dân</label>
                        <input type="number" id="editCCCD" class="form-control" />
                    </div>
                    <!-- Giá bán -->
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="editEmail" class="form-control" />
                    </div>
                    <!-- Số lượng tồn -->
                    <div class="form-group">
                        <label>Địa chỉ liên hệ</label>
                        <input type="text" id="editDiaChi" class="form-control" />
                    </div>

                    <!-- Size -->
                    <div class="form-group">
                        <label>Số điện thoại</label>
                        <input type="number" id="editSdt" class="form-control" />
                    </div>
                    <div class="form-group">
                        <div class="form-check">
                            <input type="checkbox" id="editKhoa" class="form-check-input" />
                            <label for="editKhoa" class="form-check-label">Khóa</label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-primary" id="saveEditEmployeeButton">Cập nhật</button>
                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Đóng</button>
            </div>
        </div>
    </div>
</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Sự kiện mở modal sửa
        $('#employees-table').on('click', '.btn-edit', function () {
            const employeeId = $(this).data('id');

            // Fetch thông tin chi tiết sản phẩm
            fetch(`/api/employees/${employeeId}`)
                .then(response => response.json())
                .then(employee => {
                    $('#editTenNhanVien').val(employee.tenNhanVien);
                    $('#editCCCD').val(employee.cccd);
                    $('#editSdt').val(employee.sdt);
                    $('#editEmail').val(employee.email);
                    $('#editDiaChi').val(employee.diaChi);
                    $('#editKhoa').prop( 'checked',employee.khoa);
                    // Hiển thị modal
                    $('#editEmployeeModal').modal('show');
                })
                .catch(error => {
                    console.error('Lỗi khi lấy chi tiết nhân viên:', error);
                    alert('Đã xảy ra lỗi, vui lòng thử lại!');
                });

            // Xử lý cập nhật sản phẩm
            $('#saveEditEmployeeButton').off('click').on('click', function () {
                const updatedEmployee = {
                    tenNhanVien: $('#editTenNhanVien').val(),
                    diaChi: $('#editDiaChi').val(),
                    sdt: $('#editSdt').val(),
                    email: $('#editEmail').val(),
                    cccd: $('#editCCCD').val(),
                    khoa: $('#editKhoa').is(':checked')
                };

                console.log('Updated Employee:', updatedEmployee);

                fetch(`/admin/employees/edit/${employeeId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(updatedEmployee),
                })
                    .then(response => {
                        if (!response.ok) throw new Error('Lỗi cập nhật nhân viên');
                        return response.json();
                    })
                    .then(data => {
                        alert('Cập nhật thành công!');
                        location.reload();
                    })
                    .catch(error => {
                        console.error('Lỗi:', error);
                        alert('Có lỗi xảy ra');
                    });
            });

        });
    });
</script>